import streamlit as st

st.title("LLM Embeddings for Document Retrieval")
st.write(
    "In order to use our own documents as a corpus, we need to embed them into a vector space that the LLM "
    "understands. But what do the actually look like and what's happening behind the scenes when we use them for "
    "document retrieval? Let's explore."
)

st.header("Creating embeddings")

st.write(
    "The embedding process simply takes a string and returns a vector. For OpenAI, each vector has 1536 dimensions."
)

st.code(
    """
> embeddings = OpenAIEmbeddings()
> cat_vector = embeddings.embed_query("My cat hunts mice.")
> kitten_vector = embeddings.embed_document("My kitten chases rodents.")
> jinja_vector = embeddings.embed_query("Hi {{contact.first_name}}!")
""",
    "python",
)

st.write("Let's start by creating three vectors.")

st.write(
    "You should notice that the first two are very similar, and are quite different from the last one, which is a bit of Jinja."
)
st.write(
    "But what _are_ these _actually_? Let's have a look at the first vector we created."
)

st.code("""
> cat_vector
[-0.02616932988166809, -0.0010807107901200652, 0.0053487117402255535, -0.00016734885866753757, -0.012981432490050793, 0.0377829372882843, -0.011394239962100983, -0.010439342819154263, -0.01065225899219513, -0.02831139601767063, 0.024401480332016945, 0.007613365072757006, 0.014981553889811039, -0.013975041918456554, -0.008961834013462067, -0.004538984969258308, 0.029188867658376694, -0.006071336101740599, 0.009748978540301323, -0.045318879187107086, -0.02276267111301422, 0.008936026133596897, 0.010032867081463337, -0.029240483418107033, 0.0014525074511766434, -0.005787448026239872, 0.0021388395689427853, -0.015007362700998783, 0.014155698008835316, 0.01582031510770321, 0.02068512700498104, -0.011045831255614758, 0.0003209872229490429, -0.009407022036612034, -0.019394725561141968, 0.007090752944350243, 0.023085271939635277, 0.004380911123007536, -0.0045454371720552444, -0.021807774901390076, 0.004797065164893866, 0.009355406276881695, -0.011168419383466244, 0.013613729737699032, 0.0013073374284431338, 0.0024162756744772196, -0.004113152623176575, -0.013471785001456738, -0.021459367126226425, -0.005413231905549765, 0.02311108075082302, -0.0003018328279722482, -0.013420169241726398, -0.00831663329154253, -0.016310667619109154, 0.0016791342059150338, 0.009716718457639217, -0.016413899138569832, 0.012407204136252403, -0.01825917325913906, 0.0004419623001012951, 0.0012436239048838615, -0.024814408272504807, 0.0162203386425972, 0.008903766050934792, -0.012549148872494698, 0.0022936875466257334, -0.0042776791378855705, -0.01053612306714058, -0.013910521753132343, 0.01957538165152073, -0.004038954619318247, 5.146481635165401e-05, -0.005158377345651388, 0.024969257414340973, 0.021562598645687103, -0.017588164657354355, 0.013355649076402187, -0.00016392124234698713, -0.015626754611730576, 0.03269875794649124, -0.03357623144984245, -0.017626876011490822, 0.023317543789744377, 0.026027385145425797, 0.022594919428229332, 0.0007383512565866113, 0.0244918093085289, -0.010445795021951199, 0.02748553827404976, 0.01458153035491705, 0.012858845293521881, 0.013523401692509651, 0.020878685638308525, -0.013536305166780949, -0.006374580319970846, -0.02322721667587757, 0.022956231608986855, -0.009929634630680084, -0.03938303515315056, -0.005597113631665707, 0.015252538956701756, -0.010445795021951199, -0.006787508726119995, -0.021846486255526543, -0.0010492572328075767, -0.01704619638621807, -0.003322782227769494, 0.029317907989025116, -0.04232515022158623, 0.005610018037259579, 0.02592415362596512, 0.01779462769627571, -0.019730228930711746, 0.009600582532584667, -0.015033170580863953, 0.015123498626053333, -0.009219914674758911, -0.006448778323829174, -0.002584027824923396, 0.037163544446229935, 0.008077909238636494, 0.005751961842179298, -0.004964817315340042, 0.01905922032892704, 0.02911144495010376, 0.01380728930234909, -0.017020387575030327, 0.008310182020068169, -0.0035292464308440685, 0.02107224613428116, -0.0005903583951294422, 0.029034020379185677, 0.026427410542964935, -0.03073734976351261, 0.019717326387763023, -0.025149913504719734, 0.002677581738680601, 0.0022775575052946806, -0.057087335735559464, -0.003600218566134572, 0.020775454118847847, -0.006510072387754917, -0.011387787759304047, -0.008019841276109219, 0.03667319193482399, 0.025033777579665184, -0.02114967070519924, -0.008903766050934792, 0.02437567338347435, 0.009697362780570984, -0.02010444551706314, 0.024736985564231873, -0.010071579366922379, 0.010774847120046616, -0.0033711723517626524, -0.005226123612374067, 0.020698029547929764, 0.012723352760076523, -0.030918005853891373, 0.0007198017556220293, -0.0010589351877570152, 0.029756644740700722, -0.007155273109674454, 0.012974981218576431, 0.026943570002913475, 0.026014482602477074, 0.009174750186502934, -0.009013449773192406, -0.011026475578546524, 0.027356497943401337, 0.007806925568729639, -0.010800654999911785, 0.03819586709141731, -0.013536305166780949, 0.010387727059423923, -0.0001839829346863553, 0.020517373457551003, -0.024620849639177322, -0.0005818901699967682, -0.020117349922657013, 0.005132569465786219, 0.009658650495111942, 0.009084422141313553, -0.020052829757332802, -0.009239270351827145, -0.007561749313026667, -0.02709841914474964, -0.0027066159527748823, -0.010820011608302593, 0.014852514490485191, 0.02056899107992649, -0.021588407456874847, -0.010497410781681538, -0.6693567633628845, -0.0009194106096401811, 0.0003510293608997017, 0.0012097508879378438, 0.021330326795578003, 0.028156546875834465, 0.009000546298921108, -0.0029453400056809187, -0.003005021018907428, 0.007613365072757006, -0.012955624610185623, -0.005935844033956528, 0.01103292778134346, -0.012871748767793179, -0.010174810886383057, -0.01593645103275776, 0.006393936462700367, -0.015613851137459278, -0.016413899138569832, 0.016426803544163704, -0.01610420271754265, 0.007542393170297146, -0.0010234492365270853, -0.007258505094796419, 0.02251749485731125, -0.011845880188047886, 0.0002925580774899572, -0.025666072964668274, 0.0022759444545954466, 0.045370496809482574, -0.015742890536785126, 0.01929149404168129, -0.01899470016360283, 0.01721394807100296, 0.054093606770038605, 0.006793960463255644, -0.0015008975751698017, 0.027408115565776825, 0.014116985723376274, 0.03989919647574425, -0.029834069311618805, -0.008677946403622627, 0.009174750186502934, 0.005368067882955074, -0.012994336895644665, -0.013084664940834045, 0.00691654859110713, 0.009194106794893742, 0.0008734401199035347, -0.009394118562340736, -0.011207131668925285, 0.0029356619343161583, -0.007568201050162315, 0.005610018037259579, 0.006106822285801172, 0.018852757290005684, 0.02442728914320469, -0.025962864980101585, -0.001135552767664194, -0.0065552364103496075, -0.011252296157181263, 0.01039417926222086, 0.00017904312699101865, 0.0017904312117025256, -0.024866025894880295, 0.019162453711032867, -0.006458456628024578, 0.004561567213386297, 0.020633509382605553, -0.004084118641912937, 0.023756280541419983, 0.0020097994711250067, -0.010697423480451107, 0.014981553889811039, 0.0064261965453624725, 0.003426014445722103, 0.010323206894099712, -0.026311274617910385, -0.01374276913702488, -0.0257693063467741, -0.00011270845425315201, -0.013381456956267357, -0.0296276044100523, 0.009290886111557484, 0.03078896552324295, -0.026311274617910385, -0.019381821155548096, 0.023588528856635094, 0.008019841276109219, 0.01319434866309166, 0.013013692572712898, 0.02118838205933571, 0.0056196958757936954, 0.00030163119663484395, -0.027227459475398064, 0.0031985812820494175, -0.008194046095013618, 0.010639355517923832, 0.02813073992729187, -0.026582257822155952, -0.012581408955156803, 0.0029372749850153923, 0.009516706690192223, -0.024995064362883568, 0.010007059201598167, -0.014181505888700485, -0.02153679169714451, 0.028543667867779732, 0.01291046105325222, -0.013065309263765812, -0.003519568359479308, -0.01606549136340618, -0.005148699507117271, 0.0037808746565133333, -0.00453253323212266, -0.017007483169436455, 0.008910218253731728, -0.0006113274139352143, 0.007174628786742687, -0.008187593892216682, 0.015523523092269897, 0.005426135845482349, 0.029034020379185677, -0.01899470016360283, 0.010219975374639034, 0.0023904675617814064, -0.006826220545917749, -0.01336855348199606, -0.04183479771018028, -0.004916427191346884, 0.0025162817910313606, -0.014517010189592838, -0.007542393170297146, -0.014517010189592838, 0.0027840398252010345, -0.0007242374704219401, 0.02264653518795967, -0.008006937801837921, 0.01576869934797287, 0.010910339653491974, -0.013149185106158257, -0.005322903860360384, -0.0326729491353035, -0.0013581468956544995, 0.025485416874289513, -0.011426500044763088, 7.863380233175121e-06, -0.021498078480362892, -0.001174264820292592, 0.009858663193881512, -0.0028066218364983797, -0.013149185106158257, 0.030685734003782272, -0.009490898810327053, 0.006603626534342766, -0.005316451657563448, -0.009865114465355873, -0.0121297687292099, -0.00782628171145916, -0.0002693711721803993, 0.01824626885354519, 0.0028388819191604853, -0.012426560744643211, 0.02032381482422352, -0.013768577948212624, -0.01721394807100296, 0.0022340065333992243, 0.03089219704270363, -0.013239513151347637, -0.0366215780377388, -0.0009145716321654618, -0.006793960463255644, -0.0019275363301858306, 0.018504349514842033, 0.006839124485850334, 0.011820072308182716, -0.0097941430285573, -0.04235095903277397, -0.016671979799866676, -0.0035550545435398817, 0.020710933953523636, -0.005461621563881636, 0.01354920957237482, -0.0009081196039915085, 0.009878018870949745, 0.015407386235892773, -0.006390710361301899, 0.03553764149546623, -0.0003510293608997017, 0.026711298152804375, 0.0007552877650596201, 0.0011379722272977233, -0.010478055104613304, 0.00011089382314821705, -0.011691031977534294, -0.03527956083416939, 0.013084664940834045, 0.029756644740700722, 0.016426803544163704, 0.029653413221240044, -0.0020694804843515158, -0.015678370371460915, -0.003767970483750105, -0.007181080989539623, 0.012542696669697762, -0.02686614729464054, -0.012020084075629711, -0.01611710712313652, 0.03218259662389755, -0.008613426238298416, -0.006703632418066263, -0.01062645111232996, 0.005406779702752829, -0.0006137469317764044, 0.015433195047080517, 0.03236325457692146, 0.003426014445722103, 0.0042680008336901665, 0.009710266254842281, 0.0022372326347976923, 0.012652380391955376, 0.0018339823000133038, -0.020349621772766113, -0.016155818477272987, 0.03004053235054016, 0.01628485880792141, 0.014878322370350361, 0.037576474249362946, 0.0030824451241642237, -0.00343569228425622, -0.02080126293003559, -0.005426135845482349, 0.007955321110785007, 0.0144653944298625, 0.012200740166008472, -0.019626997411251068, 0.01766558736562729, -0.007084300741553307, 0.013104020617902279, 0.020465757697820663, 0.008690849877893925, 0.024917641654610634, 0.0010048997355625033, -0.011329719796776772, 0.008161786012351513, 0.0031405130866914988, 0.021381942555308342, 0.009303790517151356, -0.011665224097669125, 0.02535637654364109, -0.012032988481223583, -0.010813559405505657, -0.009781238622963428, 0.015342867001891136, 0.006139082368463278, -0.022594919428229332, 0.002619513776153326, -0.010413534939289093, 0.02911144495010376, 0.03842813894152641, 0.002561445813626051, -0.00300986017100513, 0.008710205554962158, -0.006348772440105677, 0.028982404619455338, 0.015755794942378998, 0.006322964560240507, 0.0114910202100873, 0.013704057782888412, -0.042531613260507584, -0.027408115565776825, -0.004048632923513651, 0.01593645103275776, -0.029601795598864555, 0.039253994822502136, 0.023123983293771744, 0.004471239168196917, -0.00336472038179636, 0.01993669383227825, 0.011574896052479744, -0.016736499965190887, -0.033472999930381775, 0.020246390253305435, 0.011716839857399464, 0.004148638807237148, -0.021911006420850754, -0.0064165182411670685, -0.006506846286356449, -0.026414506137371063, -0.0031614822801202536, 0.02952437289059162, 0.003303426317870617, 0.0013525014510378242, 0.005158377345651388, 0.006464908365160227, 0.015588042326271534, 0.042660653591156006, -0.025278953835368156, 0.004961591213941574, 0.010445795021951199, -0.00691654859110713, -0.013936329632997513, -0.014233121648430824, -0.014026657678186893, 0.017704300582408905, 0.006593948695808649, 0.00556162791326642, -0.020839974284172058, -0.015794506296515465, 0.013278225436806679, -0.0192398764193058, 0.00037824874743819237, 0.009071518667042255, -0.005474525969475508, -0.03458274528384209, 0.0062294104136526585, -0.03285360708832741, -0.012691092677414417, 0.03680223226547241, 0.02841462753713131, -0.016207436099648476, -0.01686554029583931, -0.014594433829188347, -0.002821139059960842, 0.08846988528966904, 0.011426500044763088, -0.01380728930234909, 0.002638869918882847, 0.018065612763166428, -0.017226852476596832, 0.008142429403960705, -0.0068326727487146854, 0.020168965682387352, -0.009568322449922562, -0.004768031183630228, 0.027279075235128403, -0.015742890536785126, 0.005129343364387751, 0.007097204681485891, -0.003890558611601591, 0.0010024801595136523, -0.013058857060968876, 0.011213583871722221, -0.011142611503601074, 0.010316754691302776, 0.0019839913584291935, 0.001506543019786477, 0.021278711035847664, -0.0021614215802401304, 0.0035905404947698116, 0.017484931275248528, 0.01282013300806284, 0.017342988401651382, -0.03899591416120529, -0.007794021163135767, -0.0006661694496870041, 0.005874549970030785, -0.004774483386427164, 0.005458395928144455, -0.013910521753132343, 0.00034961799974553287, 0.010213523171842098, 0.019020508974790573, -0.016968771815299988, 0.033008456230163574, 0.027279075235128403, 0.01334274560213089, -0.005806804168969393, 0.004671251401305199, -0.010955503210425377, 0.003522794460877776, 0.02610480971634388, -0.006884288974106312, -0.014426682144403458, 0.030298613011837006, -0.0062294104136526585, 0.00434865104034543, 0.009948991239070892, 0.009019901975989342, 0.028724323958158493, -0.008755370043218136, 0.0005488236201927066, 0.001761397230438888, -0.028956595808267593, -0.0022356195840984583, 0.006126178428530693, -0.01203944068402052, -0.004797065164893866, 0.01062645111232996, -0.019085029140114784, -0.005887453909963369, -0.012194287963211536, -0.04281550273299217, 0.013239513151347637, -0.010878079570829868, -0.003127609146758914, -0.02529185824096203, -0.014297641813755035, 0.005116439424455166, 0.024749889969825745, 0.009445734322071075, 0.0016871991101652384, -0.0039034627843648195, 0.028027506545186043, -0.019665708765387535, -0.01739460416138172, 0.005890680011361837, -0.03176967054605484, -0.007426257245242596, -0.013781481422483921, 0.006806864868849516, -0.005900357849895954, -0.01605258695781231, -0.014297641813755035, 0.02171744778752327, -0.0014307319652289152, 0.030711540952324867, -0.00924572255462408, -0.005003529600799084, -0.011742647737264633, -0.026414506137371063, 0.0037905527278780937, -0.0018436602549627423, 0.0023388515692204237, 0.020530277863144875, -0.01796238124370575, -0.035460215061903, -0.0049325572326779366, 0.010039319284260273, -0.005903583951294422, 0.040105659514665604, 0.0127685172483325, -0.009813498705625534, -0.00574551010504365, 0.02831139601767063, -0.0020630285143852234, 0.031150277704000473, -0.012516888789832592, 0.024620849639177322, 0.028724323958158493, 0.0016412286786362529, 0.014426682144403458, 0.00791660975664854, 0.003419562242925167, -0.01651713065803051, -0.005219671409577131, 0.009884471073746681, 0.012032988481223583, -0.005255157593637705, 0.006448778323829174, -0.011078091338276863, -0.026530642062425613, -0.015923546627163887, -0.011142611503601074, -0.007329476997256279, 0.01137488428503275, -0.03287941589951515, -0.0480545274913311, -0.03032442182302475, -0.013381456956267357, -0.014826706610620022, 0.00895538181066513, -0.010110290721058846, 6.835092062829062e-05, -0.031201893463730812, 0.007432708982378244, -0.0034937604796141386, 0.010736135765910149, -0.005710023920983076, -0.025343474000692368, -0.005368067882955074, 0.01693006046116352, -0.01262012030929327, 0.013497592881321907, 0.011136159300804138, -0.00794241763651371, -0.004919653292745352, -0.018414020538330078, -0.02160130999982357, -0.03726677596569061, 0.00583583815023303, 0.025808017700910568, 0.017588164657354355, 0.013794385828077793, 0.0077746654860675335, -0.0025372507516294718, 0.010045770555734634, -0.02952437289059162, 0.00785208959132433, 0.0060842400416731834, 0.011594251729547977, 0.01507188193500042, -0.027408115565776825, 0.01716233231127262, 0.02564026601612568, -0.0031824512407183647, 0.02588544227182865, 0.013033049181103706, 0.00970381498336792, 0.008052101358771324, 0.0170332919806242, -0.024478904902935028, -0.010774847120046616, -0.005803578067570925, 0.0010839367751032114, 0.00984575878828764, 0.02696937881410122, -0.004071214701980352, 0.0062907044775784016, -0.009084422141313553, 0.03876364231109619, -0.004484143108129501, 0.014207313768565655, 0.015497714281082153, 0.02517572045326233, -0.029937300831079483, -0.009929634630680084, -0.03654415160417557, -0.014800897799432278, -0.017588164657354355, -0.0009653811575844884, 0.011826524510979652, -0.0025743497535586357, -0.011078091338276863, 0.008800533600151539, -0.003442144487053156, -0.013394361361861229, 0.015459002926945686, -0.0005008368170820177, 0.021911006420850754, -0.01010383851826191, -0.013239513151347637, 0.02333044819533825, -0.023420775309205055, -0.013729865662753582, -0.033060070127248764, -0.03050507791340351, -0.00895538181066513, 0.020530277863144875, -0.0005726154195144773, -0.017743011936545372, -0.0054003274999558926, -0.00894893053919077, -0.032079365104436874, -0.007923061028122902, 0.006168116349726915, 0.026027385145425797, -0.014594433829188347, 0.014271833933889866, 0.03460855036973953, -0.010665163397789001, -0.010239331051707268, -0.008194046095013618, 0.0020452854223549366, -0.005735831800848246, 0.016259051859378815, 0.005148699507117271, -0.006261670496314764, -0.005897132214158773, -0.018555965274572372, 0.005432587582617998, -0.01691715605556965, -0.052183810621500015, 0.032492294907569885, 0.011897495947778225, 0.002251749625429511, -0.02911144495010376, -0.02050447091460228, -0.010923243127763271, 0.011974920518696308, -0.02489183284342289, 0.0009379601688124239, -0.022504592314362526, -0.0030001820996403694, -0.04157671704888344, 0.02771781198680401, -0.01853015646338463, 0.012233000248670578, -0.015278346836566925, 0.01825917325913906, -0.01733008399605751, -0.014749282039701939, -0.013058857060968876, -0.0005226123612374067, -0.0025920928455889225, 0.024595040827989578, -0.003301813267171383, 0.0033485903404653072, 0.007987581193447113, 0.0007254472584463656, -0.023549815639853477, -0.01082646381109953, -0.0054906560108065605, 0.03145997226238251, 0.025098297744989395, 0.01663326658308506, -0.020143158733844757, 0.014917034655809402, -0.010820011608302593, -0.020633509382605553, -0.010639355517923832, -0.00791660975664854, -0.005306773819029331, -0.009542514570057392, 0.024530520662665367, 0.019136644899845123, -0.020646413788199425, -0.01051031518727541, -0.03437627851963043, 0.007561749313026667, -0.0342988558113575, -0.0005169668584130704, -0.00601972034201026, -0.01611710712313652, -0.009219914674758911, -0.006248766090720892, 0.005529367830604315, -0.010084482841193676, 0.01814303733408451, -0.0019823783077299595, 0.01178781222552061, 0.03107285313308239, -0.04113798215985298, 0.015562234446406364, -0.031098661944270134, 0.017368795350193977, -0.015665465965867043, 0.011878140270709991, 0.01646551489830017, -0.014297641813755035, 0.004584148991852999, -0.023033656179904938, -0.010071579366922379, -0.012523340992629528, -0.00517128175124526, 0.010090935043990612, 0.013962137512862682, -0.01970442198216915, 0.016530035063624382, 0.015613851137459278, 0.030479269102215767, -0.009090874344110489, 0.0005125310854054987, 0.028104931116104126, -0.017743011936545372, -0.008974738419055939, 0.008877958171069622, -0.004506724886596203, 0.022827191278338432, 0.002167873550206423, -0.0013758899876847863, 0.018104324117302895, -0.018207555636763573, -0.011516828089952469, -0.041731566190719604, 0.020349621772766113, -0.0061423080042004585, -0.03362784534692764, -0.02096901461482048, -0.013613729737699032, -0.011762004345655441, 0.012491080909967422, -0.019626997411251068, -0.01183942798525095, -0.005113213323056698, -0.0024743436370044947, -0.03339557349681854, 0.005716476123780012, -0.02223360724747181, 0.0059552001766860485, 0.008019841276109219, -0.025098297744989395, -0.034918248653411865, -0.0028824328910559416, -0.030866390094161034, 0.026530642062425613, 0.0046938331797719, 0.0008113395306281745, -0.00398411275818944, 0.01570417918264866, -0.016659075394272804, 0.004006694536656141, -0.005064823664724827, 0.0027275849133729935, 0.01174909994006157, 0.0025307987816631794, -0.008323085494339466, 0.018207555636763573, -0.00551646389067173, -0.008432770147919655, 0.004300260916352272, -0.019794749096035957, -0.011516828089952469, -0.010110290721058846, -0.014362161979079247, 0.022891711443662643, -0.0035163424909114838, -0.01911083795130253, -0.0009234431199729443, -0.01934310980141163, 0.006929452996701002, 0.02114967070519924, -0.0002082787686958909, 0.0022920744959264994, -0.023524008691310883, -0.001249269349500537, 0.03084058128297329, -0.0024324057158082724, -0.002409823704510927, 0.005574531853199005, -0.018930181860923767, 0.016671979799866676, 0.0009234431199729443, -0.018284980207681656, -0.007548845373094082, 0.004845455288887024, -0.017368795350193977, 0.010523219592869282, -0.018001092597842216, 0.0005024498677812517, -0.0068326727487146854, -0.008806985802948475, 0.0005738251493312418, -0.0016952641308307648, 0.0025695108342915773, 0.015600946731865406, 0.0030808320734649897, -0.02333044819533825, -0.03610541671514511, 0.01894308440387249, -0.001835595234297216, 0.013871809467673302, 0.00012934253027196974, -0.006487490609288216, 0.03649253770709038, 0.0014186344342306256, 0.0012186223175376654, -0.015355770476162434, -0.01733008399605751, 0.0039002366829663515, 0.000978285213932395, -0.010271591134369373, 0.0008766661048866808, -0.015691274777054787, -0.006122952327132225, -0.003977660555392504, -0.010039319284260273, -0.0035518284421414137, -0.004558341111987829, 0.005058371461927891, -0.011187775991857052, -0.005706797819584608, -0.004939009435474873, 0.004293809179216623, -0.0012371718185022473, -0.03264714404940605, -0.02529185824096203, -0.008639234118163586, 0.001273464411497116, 0.028853364288806915, 0.21843905746936798, -0.017691396176815033, 0.008439221419394016, 0.016439707949757576, -0.008574713952839375, 0.021859390661120415, 0.037395816296339035, 0.005922940094023943, 0.028104931116104126, 0.014155698008835316, 0.014091177843511105, 0.0009266691631637514, -0.00849083811044693, 0.019510861486196518, 0.019717326387763023, 0.0025114426389336586, 0.0022985266987234354, 0.01698167622089386, -0.023175599053502083, -0.030298613011837006, 0.021859390661120415, 0.007110109087079763, 0.022672343999147415, 0.0013202413683757186, 0.020775454118847847, 0.018620485439896584, -0.01158134825527668, -0.01369115337729454, -0.0023194956593215466, 0.010845819488167763, -0.014478297904133797, 0.002632417716085911, 0.009981251321732998, -0.01140714343637228, 0.007845637388527393, 0.020723838359117508, -0.01112325582653284, 0.015317058190703392, 0.00998770259320736, 0.005000303499400616, 0.0036518345586955547, -0.01744621992111206, 0.0010855497093871236, 0.020607702434062958, -0.0149299381300807, 0.03989919647574425, 0.01334274560213089, 0.0072197928093373775, 0.024182112887501717, 0.02771781198680401, -0.026788722723722458, -0.011368432082235813, 0.001229913323186338, 0.016659075394272804, -0.019962502643465996, -0.030298613011837006, 0.029937300831079483, 0.006948808673769236, 0.0032937482465058565, 0.013497592881321907, 0.007574653252959251, 0.006403614301234484, 0.006355224177241325, 0.03850556164979935, -0.018284980207681656, 0.059461671859025955, -0.028724323958158493, -0.009097326546907425, 0.024530520662665367, 0.004635765217244625, 0.0013412104453891516, 0.0042647747322916985, -0.004506724886596203, -0.026530642062425613, 0.0013766963966190815, -0.00796822551637888, 0.0004054681630805135, 0.01565256342291832, 0.010858723893761635, -0.0015879996353760362, 0.0005298708565533161, -0.012516888789832592, -0.0039937905967235565, -0.0020259295124560595, -0.01357501745223999, -0.03102123737335205, 0.0005847128923051059, 0.005897132214158773, 0.007677885238081217, -0.02010444551706314, 0.004538984969258308, -0.0009903826285153627, -0.0017291371477767825, -0.010684519074857235, 0.02078835852444172, 0.011645868420600891, 0.0011444243136793375, 0.04191222041845322, -0.004313164856284857, -0.00059560063527897, -0.023653049021959305, -0.022788479924201965, 0.019833462312817574, 0.0013033049181103706, 0.012452368624508381, 0.014968650415539742, -0.014026657678186893, 0.00476480508223176, -0.015188018791377544, -0.01091679185628891, 0.010155455209314823, -0.018284980207681656, -0.017084907740354538, 0.0058616460300982, -0.0005121278809383512, 0.02032381482422352, 0.0008492450579069555, -0.014220218174159527, 0.01343307364732027, 0.016130011528730392, -0.0018888242775574327, -0.026943570002913475, -0.005406779702752829, 0.009458638727664948, 0.005026111379265785, -0.02831139601767063, -0.015110594220459461, 0.008768274448812008, -0.015420290641486645, -0.049990128725767136, -0.012665284797549248, -0.005235801450908184, -0.000239732296904549, 0.015975162386894226, 0.00741980504244566, 0.013136280700564384, 0.008884410373866558, -0.0007669820333831012, -0.017652684822678566, 0.01605258695781231, 0.014529913663864136, -0.018297884613275528, 0.013329841196537018, 0.0242595374584198, 0.008845698088407516, 0.006710084620863199, 0.012310424819588661, 0.009568322449922562, -0.02846624329686165, -0.023265928030014038, -0.015781603753566742, 0.0032582622952759266, -0.01704619638621807, 0.001133133308030665, 0.02171744778752327, -0.035434409976005554, -0.041034746915102005, -0.03331815078854561, 0.0016121945809572935, -0.004355102777481079, -0.04333166033029556, -0.007813377305865288, 0.020349621772766113, 0.01334274560213089, 0.004426075145602226, -0.006126178428530693, -0.16362282633781433, 0.010284495539963245, 0.02431115321815014, -0.008135977201163769, -0.01204589195549488, 0.010723231360316277, 0.009639294818043709, -0.02223360724747181, -0.00849083811044693, 0.010258686728775501, 0.031201893463730812, -0.01791076362133026, -0.03200194239616394, -0.019097933545708656, -0.002545315772294998, 0.0027017768006771803, -0.008071457967162132, 0.0006318931700661778, 0.005309999454766512, 0.014220218174159527, 0.04026050865650177, -0.014504105783998966, 0.0025275726802647114, -0.02118838205933571, 0.017059098929166794, 0.0012024922762066126, -0.004245419055223465, -0.004248645156621933, -0.01034256350249052, -0.03909914568066597, 0.004032502882182598, -0.012445916421711445, 0.005403553601354361, 0.0013033049181103706, 0.016968771815299988, -0.011400692164897919, -0.01674940437078476, -0.012213644571602345, -0.007432708982378244, 0.0326729491353035, 0.014607338234782219, 0.021756159141659737, 0.01371696125715971, -0.019717326387763023, -0.010187715291976929, 0.008097265847027302, 0.019046317785978317, 0.007723049260675907, 0.00489707151427865, -0.0347633995115757, -0.007258505094796419, -0.009219914674758911, 0.012284616008400917, 0.0015162210911512375, 0.034918248653411865, 0.012362040579319, 0.029498564079403877, 0.018052708357572556, 0.013987945392727852, 0.023472392931580544, -0.009084422141313553, -0.02638869732618332, 0.020698029547929764, 0.008542453870177269, -0.005529367830604315, -0.012071700766682625, 0.00808436144143343, 0.033060070127248764, -0.015549330972135067, 0.016439707949757576, -0.016130011528730392, 0.01814303733408451, 0.024698272347450256, 0.0032082591205835342, -0.008548906072974205, 0.033060070127248764, -0.00967800710350275, 0.006242314353585243, -0.006761700846254826, 0.0036840946413576603, -0.004451883025467396, 0.020943205803632736, -0.029885685071349144, -0.029137251898646355, 0.009658650495111942, 0.0021081925369799137, 0.00503901531919837, -0.010284495539963245, 0.025859633460640907, -0.005468073766678572, 0.012749160639941692, -0.02160130999982357, -0.024504713714122772, -0.030866390094161034, 0.037344202399253845, 0.029034020379185677, 0.014852514490485191, -0.006590722594410181, 0.00886505376547575, -0.00837470218539238, 0.010910339653491974, -0.037628088146448135, -0.016762306913733482, -0.0007415772415697575, 0.007400448899716139, -0.0016468741232529283, 0.028569474816322327, 0.01053612306714058, 0.01628485880792141, -0.004455109126865864, -0.014723474159836769, 0.012168480083346367, 0.011968468315899372, 0.015149306505918503, 0.0037292586639523506, 0.010407082736492157, 0.007135916966944933, -0.001800109283067286, 0.021059341728687286, -0.02258201502263546, 0.047048017382621765, 0.013936329632997513, -0.006490716245025396, 0.009916731156408787, -0.00038691863301210105, 0.0068326727487146854, -0.10023833811283112, -0.02934371680021286, 0.009342502802610397, 0.00012863683514297009, -0.04913846403360367, 0.008026293478906155, -0.003619574476033449, 0.029214676469564438, -0.023304639384150505, 0.006361676380038261, 0.00924572255462408, -0.004519629292190075, -0.010090935043990612, 0.0026533869095146656, -0.0037066766526550055, 0.0008202110766433179, 0.0077746654860675335, -0.028982404619455338, -0.01279432512819767, 0.007077849004417658, 0.005119665525853634, 0.013039501383900642, 0.011426500044763088, -0.015871930867433548, 0.020594798028469086, -0.00207270635291934, -0.026362890377640724, 0.030169572681188583, 0.008619877509772778, -0.004593827296048403, 0.015897739678621292, -0.013962137512862682, 0.002208198420703411, -0.023924032226204872, -0.017755916342139244, 0.00037179674836806953, 0.002927596913650632, -0.0021581954788416624, 0.028930788859725, -0.00535838957875967, -0.0013823419576510787, -0.00480674346908927, -0.00503901531919837, -0.007174628786742687, 0.006545558571815491, 0.012542696669697762, -0.0016073556616902351, -0.006716536823660135, 0.010490959510207176, -0.03362784534692764, -0.025459609925746918, -0.0026243526954203844, -0.02062060683965683, -0.021627118811011314, 0.012026536278426647, -0.018968893215060234, -0.0055422717705369, 0.014826706610620022, -0.027356497943401337, 0.01756235584616661, -0.00814888160675764, -0.012116864323616028, 0.005877776071429253, 0.03078896552324295, 0.0023372385185211897, -0.006026172079145908, -0.01686554029583931, -0.017368795350193977, 0.00996189471334219, -0.022311031818389893, 0.0024743436370044947, 0.04165413975715637, -0.022659439593553543, -0.0008198078139685094, -0.024801505729556084, 0.011078091338276863, -0.002167873550206423, 0.004155091010034084, 0.014078273437917233, -0.019846364855766296, -0.028750130906701088, -0.012729804962873459, 0.005245479755103588, -0.055022694170475006, 0.017768820747733116, 0.004174446687102318, -0.028208162635564804, 0.016904251649975777, -0.0038389426190406084, 0.0024711177684366703, -0.006645564455538988, -0.0006484264740720391, 0.002661451930180192, -0.02929210104048252, -0.008271469734609127, 0.02107224613428116, -0.020594798028469086, 0.003067928133532405, 0.033060070127248764, 0.00285178585909307, -0.00340020633302629, -0.02766619436442852, -0.04707382619380951, 0.012658832594752312, -0.02095611020922661, 0.011045831255614758, 0.012749160639941692, -0.024685369804501534, 0.006168116349726915, -0.030066341161727905, -0.01744621992111206, 0.0023404646199196577, -0.02379499189555645, 0.013704057782888412, 0.005122891627252102, 0.013355649076402187, -0.003396980231627822, -0.009523158892989159, -0.004506724886596203, -0.002446922706440091, -0.0004677703254856169, 0.0011234552366659045, 0.008890862576663494, 0.01646551489830017, -0.0019856044091284275, -0.0030759931541979313, 0.003396980231627822, 0.02686614729464054, -0.016878442838788033, 0.01458153035491705, -0.022775575518608093, 0.010290946811437607, -0.003658286528661847, -0.021859390661120415, 0.014723474159836769, 0.001995282480493188, 0.00858116615563631, -0.02686614729464054, 0.015678370371460915, -0.01716233231127262, -0.010987763293087482, 0.014000849798321724, 0.004568018950521946, -0.024982161819934845, 0.011252296157181263, -0.011071640066802502, 0.0177301075309515, 0.008994094096124172, -0.00895538181066513, 0.0001224872685270384, 0.016375187784433365, 0.017523644492030144, 0.04020889103412628, 0.020246390253305435, -0.004713189322501421, -0.00998770259320736, -0.04893200099468231, -0.03084058128297329, 0.024517616257071495, 0.000723431003279984, 0.012084604240953922, -0.0249563530087471, -0.005106761585921049, 0.022736864164471626, 0.006506846286356449, -0.003658286528661847, -0.012291068211197853, -0.02224651165306568, -0.011878140270709991, -0.02524024061858654, 0.01716233231127262, -0.03866041079163551, -0.010387727059423923, -0.014375065453350544, 0.009458638727664948, -0.011329719796776772, 0.0013033049181103706, -0.001075871754437685, -0.01744621992111206, 0.0062842522747814655, -0.013678248971700668, 0.011342624202370644, -0.005545497871935368, -0.014800897799432278, 0.0030776062048971653, 8.286793308798224e-05, 0.03078896552324295, 0.02309817634522915, -0.020078638568520546, -0.0022452976554632187, 0.00033651237026788294, 0.007406901102513075, -0.005600339733064175, 0.006000364199280739, 0.02535637654364109, -0.003961530514061451, 0.013987945392727852, 0.02720165066421032, 0.0004058713966514915, -0.00602294597774744, -0.00691654859110713, 0.03724097087979317, -0.006193924229592085, -0.006761700846254826, -0.02789846807718277, -0.01360082533210516, -0.0028404949698597193, 0.004316390957683325, -0.029963107779622078, -0.021098054945468903, -0.01987217366695404, 0.028775939717888832, 0.023472392931580544, 0.0029227579943835735, 0.014452490024268627, 0.014504105783998966, 0.004777709487825632, 0.02911144495010376, -0.01305240485817194, -0.04235095903277397, -0.025537034496665, 0.018749525770545006, 0.0038163606077432632, 0.00872310996055603, -0.007310120854526758, -0.01934310980141163, -0.010361919179558754, 0.009200558066368103, 0.0461963526904583, -0.008245661854743958, 0.004784161224961281, -0.0127685172483325, -0.015497714281082153, -0.017084907740354538, -0.024762792512774467, 0.008052101358771324, -0.026659682393074036, -0.014749282039701939, 0.0006540719768963754, 0.018272075802087784, -0.0174978356808424, 0.040466971695423126, -0.00924572255462408, -0.011258747428655624, -0.022853000089526176, -0.008439221419394016, -0.0073036691173911095, 0.035202134400606155, 0.01727846823632717, -0.029705028980970383, 0.016891347244381905, -0.0013323388993740082, -0.001446055481210351, 0.022143280133605003, -0.0052132196724414825, -0.00895538181066513, -0.0029630830977112055, -0.024388575926423073, -0.0013920199126005173, -0.008071457967162132, 0.0019807652570307255, 0.029937300831079483, 0.009968346916139126, 0.024169208481907845, -0.0016839731251820922, -0.0342988558113575, -0.01507188193500042, 0.03373108059167862, 0.013136280700564384, -0.0031195441260933876, -0.01739460416138172, 0.007381093222647905, -0.009381214156746864, -0.031098661944270134, 0.0019114062888547778, 0.004661573097109795, 0.004732545465230942, -0.004780935123562813, -0.012916913256049156, 0.00952961016446352, 0.033292341977357864, -0.006819768808782101, -0.01865919679403305, -0.006703632418066263, 0.008426317945122719, 0.016659075394272804, 0.01183942798525095, -0.020981919020414352, 0.01814303733408451, -0.027459731325507164]
"""
)

st.write("Easy, right? It's just a big list of floats.")
st.write(
    "So now that we've converted our documents to embeddings, how do we use them when we want to make an LLM query?"
)

st.header("Retrieving embeddings")

st.write("Let's say the user makes a query like this:")

st.code(
    """
> query = "Lions tend to enjoy hunting."
"""
)

st.write(
    "We can embed this query and then compare it to our document vectors to find the most similar document by simply "
    "taking the dot product of the query vector and each document vector, producing a scalar which we can think of as "
    "a measure of similarity (or _score_)."
)

st.code(
    """
> numpy.dot(query_vector, cat_hunts_mice)
0.838113773241518

> numpy.dot(query_vector, kitten_chases_rodents)
0.8061564239371721

> numpy.dot(query_vector, jinja_vector)
0.6923842044998137
"""
)

st.write("Here, we can see that although the query never mentions cats, mice, kittens, chasing, or rodents, the "
         "embeddings have encoded the information necessary to make the connection between the query and cat/kitten "
         "documents, and therefore we know that these are most likely to include valuable context for our LLM prompt.")